<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SpareBank 1 – Data Viewer</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app-shell">
    <nav class="main-nav">
      <button class="nav-link active" type="button" data-view="home">Hjem</button>
      <button class="nav-link" type="button" data-view="konto">Konto</button>
      <button class="nav-link" type="button" data-view="transaksjoner">Transaksjoner</button>
    </nav>
    <header class="app-header">
      <div>
        <p class="eyebrow">SpareBank 1 API via proxy</p>
        <h1>Kontodashboard</h1>
        <p class="lede">Henter kontoer og saldo via serverless-proxy uten at secrets havner i frontend.</p>
      </div>
      <div class="header-actions">
        <button id="refresh-button" class="primary-button">Oppdater data</button>
        <p id="last-updated" class="meta-text">Sist oppdatert: –</p>
      </div>
    </header>

    <main>
      <div class="views">
        <section class="view active" data-view="home">
          <div class="summary-stack">
            <section class="summary-panel summary-panel-duplicate">
              <div>
                <p class="label">Totalt tilgjengelig</p>
                <p class="summary-value js-total-balance">–</p>
              </div>
              <div>
                <p class="label">Antall kontoer</p>
                <p class="summary-value js-account-count">–</p>
              </div>
              <div>
                <p class="label">Status</p>
                <p class="status-pill status-idle js-api-status">Avventer</p>
              </div>
            </section>

            <section class="summary-panel">
              <div>
                <p class="label">Totalt tilgjengelig</p>
                <p class="summary-value js-total-balance">–</p>
              </div>
              <div>
                <p class="label">Antall kontoer</p>
                <p class="summary-value js-account-count">–</p>
              </div>
              <div>
                <p class="label">Status</p>
                <p class="status-pill status-idle js-api-status">Avventer</p>
              </div>
            </section>
          </div>
        </section>

        <section class="view" data-view="konto">
          <section id="accounts" class="cards-panel">
            <div class="panel-header">
              <h2>Kontoer</h2>
              <p class="meta-text">Listen hentes via Netlify Function som proxier mot SpareBank 1.</p>
            </div>
            <div id="accounts-grid" class="accounts-grid">
              <!-- Konto-kort rendres her -->
            </div>
          </section>
        </section>

        <section class="view" data-view="transaksjoner">
          <section id="transactions" class="cards-panel">
            <div class="panel-header">
              <h2>Transaksjoner</h2>
              <div class="tab-toggle">
                <button class="pill-button active" data-tab="standard">Standard</button>
                <button class="pill-button" data-tab="classified">Classified</button>
              </div>
            </div>

            <form id="transactions-filters" class="filters">
              <div class="filter-field">
                <label>Account keys (kommaseparert)</label>
                <input id="filter-accountKey" type="text" placeholder="QeDJBRXWQaY8BkaSjgXT, ..." />
              </div>
              <div class="filter-row">
                <div class="filter-field">
                  <label>Fra dato</label>
                  <input id="filter-fromDate" type="date" />
                </div>
                <div class="filter-field">
                  <label>Til dato</label>
                  <input id="filter-toDate" type="date" />
                </div>
                <div class="filter-field">
                  <label>Row limit</label>
                  <input id="filter-rowLimit" type="number" min="1" step="1" placeholder="f.eks. 100" />
                </div>
                <div class="filter-field">
                  <label>Source</label>
                  <select id="filter-source">
                    <option value="">(alle)</option>
                    <option value="RECENT">RECENT</option>
                    <option value="HISTORIC">HISTORIC</option>
                    <option value="ALL">ALL</option>
                  </select>
                </div>
              </div>
              <div class="filter-actions">
                <button type="submit" class="primary-button small">Oppdater</button>
                <button type="button" id="export-csv" class="secondary-button">Eksporter CSV</button>
                <span id="transactions-status" class="meta-text"></span>
              </div>
            </form>

            <div class="table-wrapper">
              <table class="transactions-table">
                <thead>
                  <tr>
                    <th>Dato</th>
                    <th>Beskrivelse</th>
                    <th>Merchant</th>
                    <th>Beløp</th>
                    <th>Valuta</th>
                    <th>Status</th>
                    <th>Konto</th>
                    <th class="classified-col">Kategori</th>
                  </tr>
                </thead>
                <tbody id="transactions-body">
                  <tr><td colspan="8" class="meta-text">Ingen data</td></tr>
                </tbody>
              </table>
            </div>
          </section>
        </section>
      </div>
    </main>

    <div id="transaction-modal" class="modal hidden">
      <div class="modal-content">
        <button class="close-modal" id="close-modal" aria-label="Lukk detaljer">×</button>
        <div id="modal-body">
          <p class="meta-text">Laster …</p>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="app.js"></script>
</body>
</html>
